<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Allenamento üèãÔ∏è‚Äç‚ôÇÔ∏è</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --bg: #f0f4f8;
  --card: #ffffff;
  --accent: #2ecc71;
  --accent-dark: #27ae60;
  --muted: #6b7280;
  --danger: #e74c3c;
  --weight-color: #3498db;
  --reps-color: #e67e22;
  --time-color: #9b59b6;
  font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, Arial;
}

body { margin: 0; background: var(--bg); color: #111; }

header {
  text-align: center;
  padding: 20px;
  color: white;
  position: relative;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  background: linear-gradient(135deg, #6a11cb, #2575fc);
  background-size: 400% 400%;
  animation: gradientAnimation 15s ease infinite;
}
header h1 { position: relative; z-index: 1; margin: 0; font-size: 1.8rem; }
@keyframes gradientAnimation { 0% {background-position: 0% 50%;} 50% {background-position: 100% 50%;} 100% {background-position: 0% 50%;} }

.container { max-width: 800px; margin: auto; padding: 10px; }
.controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-bottom: 15px; }
.controls select { padding: 10px; border-radius: 8px; border: 1px solid #ccc; flex: 1; }
.btn { background: #ddd; border: none; border-radius: 8px; padding: 8px 12px; cursor: pointer; transition: all 0.2s; }
.btn.primary { background: var(--accent); color: white; }
.btn.primary:hover { background: var(--accent-dark); }
.btn.danger { background: var(--danger); color: white; }
.btn:hover { opacity: 0.9; }

.card { background: var(--card); padding: 15px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 12px; transition: transform 0.2s; }
.card:hover { transform: translateY(-2px); }
.exercise { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; padding: 8px 0; }
.exercise .info { flex: 1; }
.exercise input { width: 70px; padding: 6px; border: 1px solid #ccc; border-radius: 6px; margin-right: 5px; cursor: pointer; }

.weight-history, .reps-history, .time-display { font-size: 0.85rem; margin-top: 3px; font-weight: 500; }
.weight-history { color: var(--weight-color); }
.reps-history { color: var(--reps-color); }
.time-display { color: var(--time-color); }

.modal { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); z-index: 1000; }
.modal.hidden { display: none; }
.modal-content { width: 90%; max-width: 400px; padding: 20px; background: var(--card); border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
.modal-content input { width: 100%; padding: 10px; margin-top: 8px; border-radius: 8px; border: 1px solid #ccc; }
.modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }

@media (max-width: 600px) { .controls { flex-direction: column; } .exercise input { width: 60px; margin-bottom: 5px; } }
</style>
</head>
<body>
<header>
  <h1>Allenamento üèãÔ∏è‚Äç‚ôÇÔ∏è</h1>
</header>

<div class="container">
  <div class="controls">
    <select id="daySelect">
      <option value="Luned√¨">Luned√¨</option>
      <option value="Marted√¨">Marted√¨</option>
      <option value="Mercoled√¨">Mercoled√¨</option>
      <option value="Gioved√¨">Gioved√¨</option>
      <option value="Venerd√¨">Venerd√¨</option>
      <option value="Sabato">Sabato</option>
      <option value="Domenica">Domenica</option>
    </select>
    <button class="btn primary" id="addExerciseBtn"><i class="fa fa-plus"></i> Aggiungi esercizio</button>
  </div>

  <h2 id="dayTitle">Luned√¨</h2>
  <div id="exerciseContainer"></div>
</div>

<!-- Modal -->
<div id="modal" class="modal hidden">
  <div class="modal-content">
    <h3>Aggiungi esercizio</h3>
    <input type="text" id="newExerciseName" placeholder="Nome esercizio">
    <input type="number" id="newExerciseWeight" placeholder="Peso (kg)">
    <input type="text" id="newExerciseReps" placeholder="Ripetizioni (libere)">
    <input type="number" id="newExerciseTime" placeholder="Tempo (minuti)">
    <div class="modal-actions">
      <button class="btn primary" id="saveExerciseBtn"><i class="fa fa-save"></i> Salva</button>
      <button class="btn danger" id="closeModalBtn"><i class="fa fa-times"></i> Chiudi</button>
    </div>
  </div>
</div>

<script>
const daySelect = document.getElementById("daySelect");
const dayTitle = document.getElementById("dayTitle");
const exerciseContainer = document.getElementById("exerciseContainer");
const addExerciseBtn = document.getElementById("addExerciseBtn");
const modal = document.getElementById("modal");
const saveExerciseBtn = document.getElementById("saveExerciseBtn");
const closeModalBtn = document.getElementById("closeModalBtn");
const newExerciseName = document.getElementById("newExerciseName");
const newExerciseWeight = document.getElementById("newExerciseWeight");
const newExerciseReps = document.getElementById("newExerciseReps");
const newExerciseTime = document.getElementById("newExerciseTime");

const STORAGE_KEY = "gym_notes_premium";

function loadData() { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); }
function saveData(data) { localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

let dragSrcIndex = null;

function renderExercises() {
  const data = loadData();
  const day = daySelect.value;
  dayTitle.textContent = day;
  const exercises = data[day] || [];
  exerciseContainer.innerHTML = "";

  exercises.forEach((ex, index) => {
    const div = document.createElement("div");
    div.classList.add("card", "exercise");
    div.setAttribute("draggable", true);
    div.dataset.index = index;

    div.addEventListener("dragstart", (e) => { dragSrcIndex = index; div.style.opacity = "0.5"; });
    div.addEventListener("dragend", () => { dragSrcIndex = null; div.style.opacity = "1"; });
    div.addEventListener("dragover", (e) => e.preventDefault());
    div.addEventListener("drop", () => { if (dragSrcIndex !== null && dragSrcIndex !== index) swapExercises(day, dragSrcIndex, index); });

    const weightHistoryText = ex.weightHistory?.length ? ex.weightHistory.join(" ‚Üí ") + " kg" : "";
    const repsText = ex.reps ? ex.reps : "";
    const timeText = ex.cardio ? ex.cardio + " min" : "";

    let infoHTML = `<strong>${ex.name}</strong>`;
    if (timeText) infoHTML += `<div class="time-display"><i class="fa fa-clock"></i> ${timeText}</div>`;
    if (weightHistoryText) infoHTML += `<div class="weight-history"><i class="fa fa-dumbbell"></i> ${weightHistoryText}</div>`;
    if (repsText) infoHTML += `<div class="reps-history"><i class="fa fa-repeat"></i> ${repsText}</div>`;

    div.innerHTML = `
      <div class="info">${infoHTML}</div>
      ${(weightHistoryText || repsText) ? `
      <div>
        <input type="number" placeholder="kg" value="${ex.weightHistory?.[ex.weightHistory.length-1] || ""}" id="weight-${day}-${index}" />
        <input type="text" placeholder="Ripetizioni" value="${ex.reps || ""}" id="reps-${day}-${index}" />
        <button class="btn primary" onclick="saveRecord('${day}', ${index})"><i class="fa fa-save"></i></button>
        <button class="btn danger" onclick="deleteExercise('${day}', ${index})"><i class="fa fa-trash"></i></button>
      </div>` : `
      <div>
        <button class="btn danger" onclick="deleteExercise('${day}', ${index})"><i class="fa fa-trash"></i> Elimina</button>
      </div>`}
    `;

    exerciseContainer.appendChild(div);
  });
}

// Swap esercizi
function swapExercises(day, from, to) {
  const data = loadData();
  const exercises = data[day];
  const [moved] = exercises.splice(from, 1);
  exercises.splice(to, 0, moved);
  saveData(data);
  renderExercises();
}

function saveRecord(day, index) {
  const data = loadData();
  const ex = data[day][index];
  const weightInput = document.getElementById(`weight-${day}-${index}`);
  const repsInput = document.getElementById(`reps-${day}-${index}`);
  const newWeight = parseFloat(weightInput.value);
  const newReps = repsInput.value.trim();
  const lastWeight = ex.weightHistory?.[ex.weightHistory.length - 1] || null;
  if (!isNaN(newWeight) && newWeight !== lastWeight) {
    if (!ex.weightHistory) ex.weightHistory = [];
    ex.weightHistory.push(newWeight);
  }
  if (newReps !== "") ex.reps = newReps;
  saveData(data);
  renderExercises();
}

addExerciseBtn.addEventListener("click", () => {
  newExerciseName.value = "";
  newExerciseWeight.value = "";
  newExerciseReps.value = "";
  newExerciseTime.value = "";
  modal.classList.remove("hidden");
});

saveExerciseBtn.addEventListener("click", () => {
  const name = newExerciseName.value.trim();
  const weight = parseFloat(newExerciseWeight.value);
  const reps = newExerciseReps.value.trim();
  const cardio = parseInt(newExerciseTime.value);
  if (!name) return alert("Inserisci un nome per l'esercizio.");
  const data = loadData();
  const day = daySelect.value;
  if (!data[day]) data[day] = [];
  const newEx = { name, reps: reps !== "" ? reps : null, weightHistory: !isNaN(weight) ? [weight] : [], cardio: !isNaN(cardio) ? cardio : null };
  data[day].push(newEx);
  saveData(data);
  modal.classList.add("hidden");
  renderExercises();
});

closeModalBtn.addEventListener("click", () => modal.classList.add("hidden"));

function deleteExercise(day, index) {
  if (!confirm("Vuoi eliminare questo esercizio?")) return;
  const data = loadData();
  data[day].splice(index, 1);
  saveData(data);
  renderExercises();
}

daySelect.addEventListener("change", renderExercises);
renderExercises();
</script>
</body>
</html>
